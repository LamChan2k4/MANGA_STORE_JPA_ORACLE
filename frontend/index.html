<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D-SHIN MANGA | N·ªÅn t·∫£ng s·ªë 1</title>
    <!-- L∆∞u √Ω: Style c√≥ th·ªÉ t√°ch ra file ri√™ng ho·∫∑c ƒë·ªÉ chung -->
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <!-- 1. THANH HEADER -->
    <header class="app-header">
        <div class="header-container">
            <div class="logo" onclick="showView('home-view')">
                <i class="fa-solid fa-book-open"></i> D-SHIN <span>MANGA</span>
            </div>

            <div class="header-right">
                <!-- V√ôNG KHI ƒê√É ƒêƒÇNG NH·∫¨P -->
                <div id="user-info-section" class="user-meta" style="display:none;">
                    <div class="wallet-pills">
                        <i class="fa-solid fa-gem"></i> <span id="user-balance">0</span> VNƒê
                    </div>
                    <span id="display-username" style="margin: 0 15px; font-weight: 600; color: #fff;"></span>
                    <button onclick="handleDeposit()" style="margin-left: 10px; background: #27ae60; border:none; border-radius:4px; color:white; cursor:pointer; padding: 2px 8px; font-size: 11px;">+ N·∫†P</button>
                    <button class="btn-logout" onclick="handleLogout()">Tho√°t</button>
                </div>

                <!-- V√ôNG KHI CH∆ØA ƒêƒÇNG NH·∫¨P -->
                <div id="auth-buttons-section">
                    <button class="btn-text" onclick="showView('login-view')">ƒêƒÉng nh·∫≠p</button>
                    <button class="btn-primary" onclick="showView('register-view')" style="padding: 8px 15px;">ƒêƒÉng k√Ω</button>
                </div>

                <button class="btn-icon" onclick="showView('admin-view')"><i class="fa-solid fa-user-gear"></i></button>
            </div>
        </div>
    </header>

    <main class="main-layout">

        <!-- A. TRANG CH·ª¶ -->
        <section id="home-view" class="view">
            <div class="hero-banner">
                <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi D-Shin Store</h1>
                <p>H·ªá th·ªëng l√µi Java Spring Boot - K·∫øt n·ªëi Oracle Database.</p>
            </div>
            <div class="section-header">
                <h2>üìö TRUY·ªÜN M·ªöI C·∫¨P NH·∫¨T</h2>
                <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm nhanh...">
            </div>
            <div id="mangaGrid" class="manga-grid">
                <!-- Truy·ªán s·∫Ω n·ªï v√†o ƒë√¢y t·ª´ Javascript -->
            </div>
        </section>

        <!-- B. CHI TI·∫æT TRUY·ªÜN -->
        <section id="detail-view" class="view" style="display:none;">
            <div class="container">
                <button class="btn-secondary" onclick="showView('home-view')" style="margin-bottom:15px">‚¨Ö Quay l·∫°i c·ª≠a h√†ng</button>
                <div class="book-detail-card">
                    <div class="detail-left">
                        <img id="detail-cover" src="https://placehold.jp/300x450.png" alt="B√¨a truy·ªán">
                    </div>
                    <div class="detail-right">
                        <!-- Ti√™u ƒë·ªÅ truy·ªán + N√∫t s·ª≠a s·∫Ω hi·ªán ·ªü ƒë√¢y -->
                        <h1 id="detail-title">Loading...</h1> 
                        <p class="author">T√°c gi·∫£: <span id="detail-author">...</span></p>
                        <hr style="border: 1px solid #333; margin: 15px 0;">
                        <h3 style="color:#27ae60">Danh s√°ch Ch∆∞∆°ng:</h3>
                        <div id="chapterList" class="chapter-list">
                            <!-- C√°c chapter mua/ƒë·ªçc s·∫Ω hi·ªán ·ªü ƒë√¢y -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- [M·ªöI] F. TRANG CH·ªàNH S·ª¨A TRUY·ªÜN (EDIT) -->
        <section id="edit-view" class="view" style="display:none;">
            <div class="auth-card" style="max-width: 600px; border: 1px solid #d35400;">
                <h2 style="color: #e67e22;"><i class="fa-solid fa-pen-to-square"></i> Hi·ªáu Ch·ªânh D·ªØ Li·ªáu</h2>
                <p style="font-size: 12px; color: #aaa; text-align: center; margin-bottom: 20px;">D√†nh cho Admin - C·∫≠p nh·∫≠t tr·ª±c ti·∫øp v√†o Oracle</p>
                
                <div style="text-align: left; margin-bottom: 10px;">
                    <label>T√™n truy·ªán:</label>
                    <input type="text" id="edit-title" style="width: 100%; padding: 10px; margin-top:5px; background: #222; border: 1px solid #444; color: white;">
                </div>
                
                <div style="text-align: left; margin-bottom: 10px;">
                    <label>T√°c gi·∫£:</label>
                    <input type="text" id="edit-author" style="width: 100%; padding: 10px; margin-top:5px; background: #222; border: 1px solid #444; color: white;">
                </div>
                
                <div style="text-align: left; margin-bottom: 10px;">
                    <label>Gi√° b√°n (VNƒê):</label>
                    <input type="number" id="edit-price" style="width: 100%; padding: 10px; margin-top:5px; background: #222; border: 1px solid #444; color: white;">
                </div>
                
                <div style="text-align: left; margin-bottom: 20px;">
                    <label>Link ·∫£nh b√¨a:</label>
                    <input type="text" id="edit-imageUrl" style="width: 100%; padding: 10px; margin-top:5px; background: #222; border: 1px solid #444; color: white;">
                </div>

                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button onclick="saveEditManga()" class="btn-primary" style="background: #27ae60;"><i class="fa-solid fa-save"></i> L∆∞u Thay ƒê·ªïi</button>
                    <button onclick="deleteManga()" class="btn-primary" style="background: #c0392b;"><i class="fa-solid fa-trash"></i> X√≥a Truy·ªán</button>
                    <button onclick="showView('home-view')" class="btn-secondary">Hu·ª∑ B·ªè</button>
                </div>
            </div>
        </section>

        <!-- C. ƒêƒÇNG NH·∫¨P -->
        <section id="login-view" class="view" style="display:none;">
            <div class="auth-card">
                <h2>üîë ƒêƒÉng Nh·∫≠p</h2>
                <input type="text" id="login-username" placeholder="T√™n ƒëƒÉng nh·∫≠p">
                <input type="password" id="login-password" placeholder="M·∫≠t kh·∫©u">
                <button onclick="handleLogin()" class="btn-primary">V√†o h·ªá th·ªëng</button>
                <button onclick="showView('home-view')" class="btn-secondary">Hu·ª∑ - Quay l·∫°i</button>
            </div>
        </section>

        <!-- D. ƒêƒÇNG K√ù -->
        <section id="register-view" class="view" style="display:none;">
            <div class="auth-card">
                <h2>‚ú® ƒêƒÉng K√Ω T√†i Kho·∫£n</h2>
                <input type="text" id="reg-username" placeholder="Nh·∫≠p t√™n t√†i kho·∫£n">
                <input type="password" id="reg-password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                <button onclick="handleRegister()" class="btn-primary" style="background:#27ae60">ƒêƒÉng k√Ω ngay</button>
                <button onclick="showView('home-view')" class="btn-secondary">Hu·ª∑ - Quay l·∫°i</button>
            </div>
        </section>

        <!-- E. QU·∫¢N TR·ªä ADMIN (N·ªîI DUNG & PDF) -->
        <section id="admin-view" class="view" style="display:none;">
            <div class="container">
                <button class="btn-secondary" style="margin-bottom:20px" onclick="showView('home-view')">üè† V·ªÅ Trang Ch·ªß</button>
                <div class="admin-panel-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                    <!-- Th·∫ª 1: T·∫°o Metadata -->
                    <div class="admin-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px;">
                        <h3 style="color:#3498db">1. Kh·ªüi t·∫°o Truy·ªán M·ªõi</h3>
                        <input type="text" id="add-title" placeholder="T√™n truy·ªán" style="display:block; width:100%; margin-bottom:10px; padding:8px;">
                        <input type="text" id="add-author" placeholder="T√°c gi·∫£" style="display:block; width:100%; margin-bottom:10px; padding:8px;">
                        <input type="number" id="add-price" placeholder="Gi√° ti·ªÅn m·∫∑c ƒë·ªãnh" style="display:block; width:100%; margin-bottom:10px; padding:8px;">
                        <input type="text" id="add-imageUrl" placeholder="Link ·∫£nh b√¨a (URL)" style="display:block; width:100%; margin-bottom:10px; padding:8px;">
                        <button onclick="addManga()" class="btn-primary" style="width:100%">Ghi v√†o Oracle</button>
                    </div>
                    
                    <!-- Th·∫ª 2: N·∫°p PDF -->
                    <div class="admin-card" style="background: #1a1a1a; padding: 20px; border-radius: 8px;">
                        <h3 style="color:#e74c3c">2. X·ª≠ l√Ω PDF (Java PDFBox)</h3>
                        <p style="font-size:13px; color:#ccc">Ch·ªçn m·ªôt cu·ªën s√°ch ngo√†i trang ch·ªß, r·ªìi v√†o ƒë√¢y n·∫°p file.</p>
                        <p id="target-book-label" style="font-weight:bold; color:#f1c40f; border: 1px dashed #666; padding: 5px;">üî¥ Ch∆∞a ch·ªçn truy·ªán n√†o!</p>
                        
                        <input type="file" id="pdfFile" accept=".pdf" style="margin: 15px 0;">
                        <button onclick="uploadMangaPdf()" class="btn-primary" style="background:#e67e22; width:100%">üöÄ X·∫ª ·∫£nh & Upload</button>
                        <div id="status" class="status-msg" style="margin-top:10px; color:#2ecc71;">S·∫µn s√†ng</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- F. TR√åNH ƒê·ªåC (FULL SCREEN) -->
        <section id="reader-view" class="view" style="display:none; background:#000; position:fixed; top:0; left:0; width:100%; height:100%; z-index:5000; overflow-y:auto;">
            <div class="reader-nav" style="position:sticky; top:0; background:rgba(20,20,20,0.9); padding:15px; display:flex; justify-content:space-between; align-items: center; border-bottom: 1px solid #333;">
                <button onclick="showView('detail-view')" style="background:transparent; border:1px solid #555; color:white; padding: 5px 10px; cursor: pointer;">‚úñ ƒê√≥ng</button>
                <span id="reading-title" style="color:white; font-weight:bold;">Reading...</span>
                <button onclick="window.scrollTo(0,0)" style="background:transparent; border:1px solid #555; color:white; padding: 5px 10px; cursor: pointer;">‚Üë TOP</button>
            </div>
            <!-- ·∫¢nh truy·ªán s·∫Ω load v√†o ƒë√¢y -->
            <div id="imageLoader" style="max-width:800px; margin:0 auto; padding-bottom: 50px;"></div>
        </section>

    </main>

    <!-- N·∫°p file Javascript logic -->
    <!-- ƒê·∫£m b·∫£o t√™n file js c·ªßa b·∫°n ƒë√∫ng l√† script.js (ho·∫∑c ƒë·ªïi th√†nh index.js n·∫øu c·∫ßn) -->
    <script src="script.js"></script> 
</body>
</html>