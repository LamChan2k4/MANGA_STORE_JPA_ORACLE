<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D-SHIN MANGA | N·ªÅn t·∫£ng s·ªë 1</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <!-- 1. THANH HEADER (Ghi ƒëi·ªÉm v·ªÅ UX) -->
    <header class="app-header">
        <div class="header-container">
            <div class="logo" onclick="showView('home-view')">
                <i class="fa-solid fa-book-open"></i> D-SHIN <span>MANGA</span>
            </div>

            <div class="header-right">
                <!-- V√ôNG KHI ƒê√É ƒêƒÇNG NH·∫¨P -->
                <div id="user-info-section" class="user-meta" style="display:none;">
                    <div class="wallet-pills">
                        <i class="fa-solid fa-gem"></i> <span id="user-balance">0</span> VNƒê
                    </div>
                    <span id="display-username" style="margin: 0 15px; font-weight: 600; color: #fff;"></span>
                    <button onclick="handleDeposit()" style="margin-left: 10px; background: #27ae60; padding: 2px 8px; font-size: 11px;">+ N·∫†P</button>
                    <button class="btn-logout" onclick="handleLogout()">Tho√°t</button>
                </div>

                <!-- V√ôNG KHI CH∆ØA ƒêƒÇNG NH·∫¨P -->
                <div id="auth-buttons-section">
                    <button class="btn-text" onclick="showView('login-view')">ƒêƒÉng nh·∫≠p</button>
                    <button class="btn-primary" onclick="showView('register-view')" style="padding: 8px 15px;">ƒêƒÉng k√Ω</button>
                </div>

                <button class="btn-icon" onclick="showView('admin-view')"><i class="fa-solid fa-user-gear"></i></button>
            </div>
        </div>
    </header>

    <main class="main-layout">

        <!-- A. TRANG CH·ª¶ -->
        <section id="home-view" class="view">
            <div class="hero-banner">
                <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi D-Shin Store</h1>
                <p>N·∫°p truy·ªán Oneshot b·∫±ng PDF, x·∫ª ·∫£nh t·ª± ƒë·ªông c·ª±c ch·∫•t.</p>
            </div>
            <div class="section-header">
                <h2>üìö TRUY·ªÜN M·ªöI C·∫¨P NH·∫¨T</h2>
                <input type="text" id="searchInput" onkeyup="handleSearch()" placeholder="T√¨m truy·ªán...">
            </div>
            <div id="mangaGrid" class="manga-grid"></div>
        </section>

        <!-- B. CHI TI·∫æT TRUY·ªÜN -->
        <section id="detail-view" class="view" style="display:none;">
            <div class="container">
                <button class="btn-secondary" onclick="showView('home-view')">‚¨Ö Quay l·∫°i c·ª≠a h√†ng</button>
                <div class="book-detail-card">
                    <div class="detail-left"><img id="detail-cover" src=""></div>
                    <div class="detail-right">
                        <h1 id="detail-title"></h1>
                        <p class="author">T√°c gi·∫£: <span id="detail-author"></span></p>
                        <div id="chapterList" class="chapter-list"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- C. ƒêƒÇNG NH·∫¨P / ƒêƒÇNG K√ù (N∆†I THI·∫æU N√öT QUAY L·∫†I) -->
        <section id="login-view" class="view" style="display:none;">
            <div class="auth-card">
                <h2>üîë ƒêƒÉng Nh·∫≠p</h2>
                <input type="text" id="login-username" placeholder="T√™n ƒëƒÉng nh·∫≠p">
                <input type="password" id="login-password" placeholder="M·∫≠t kh·∫©u">
                <button onclick="handleLogin()" class="btn-primary">V√†o h·ªá th·ªëng</button>
                <button onclick="showView('home-view')" class="btn-secondary">Hu·ª∑ - Quay l·∫°i</button>
            </div>
        </section>

        <section id="register-view" class="view" style="display:none;">
            <div class="auth-card">
                <h2>‚ú® ƒêƒÉng K√Ω T√†i Kho·∫£n</h2>
                <input type="text" id="reg-username" placeholder="Nh·∫≠p t√™n t√†i kho·∫£n">
                <input type="password" id="reg-password" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                <button onclick="handleRegister()" class="btn-primary" style="background:#27ae60">ƒêƒÉng k√Ω ngay</button>
                <button onclick="showView('home-view')" class="btn-secondary">Hu·ª∑ - Quay l·∫°i</button>
            </div>
        </section>

        <!-- D. QU·∫¢N TR·ªä ADMIN (N·ªîI DUNG & PDF) -->
        <section id="admin-view" class="view" style="display:none;">
            <div class="container">
                <button class="btn-secondary" style="margin-bottom:20px" onclick="showView('home-view')">üè† V·ªÅ Trang Ch·ªß</button>
                <div class="admin-panel-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:20px;">
                    <div class="admin-card">
                        <h3>1. T·∫°o truy·ªán</h3>
                        <input type="text" id="add-title" placeholder="T√™n truy·ªán">
                        <input type="text" id="add-author" placeholder="T√°c gi·∫£">
                        <input type="number" id="add-price" placeholder="Gi√°">
                        <input type="text" id="add-imageUrl" placeholder="Link ·∫£nh b√¨a">
                        <button onclick="addManga()" class="btn-primary">Ghi v√†o Oracle</button>
                    </div>
                    <div class="admin-card">
                        <h3>2. X·∫ª PDF</h3>
                        <p id="target-book-label">Ch∆∞a ch·ªçn truy·ªán</p>
                        <input type="file" id="pdfFile" accept=".pdf">
                        <button onclick="uploadMangaPdf()" class="btn-accent">üöÄ X·∫ª ·∫£nh ngay</button>
                        <div id="status" class="status-msg">S·∫µn s√†ng</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- E. TR√åNH ƒê·ªåC (M·∫∂C ƒê·ªäNH ·∫®N) -->
        <section id="reader-view" class="view" style="display:none; background:#000; position:fixed; top:0; left:0; width:100%; height:100%; z-index:5000; overflow-y:auto;">
            <div class="reader-nav" style="position:sticky; top:0; background:#111; padding:15px; display:flex; justify-content:space-between;">
                <button onclick="showView('detail-view')">‚úñ ƒê√≥ng</button>
                <span id="reading-title"></span>
                <button onclick="window.scrollTo(0,0)">‚Üë TOP</button>
            </div>
            <div id="imageLoader" style="max-width:800px; margin:0 auto;"></div>
        </section>

    </main>

    <!-- Popup S·ª≠a -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h3>S·ª≠a truy·ªán</h3>
            <input type="hidden" id="edit-id">
            <input type="text" id="edit-title"><input type="number" id="edit-price">
            <button onclick="saveEdit()" class="btn-primary">L∆∞u</button>
            <button onclick="closeModal()">ƒê√≥ng</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>